{"ast":null,"code":"import React,{useEffect,useState}from'react';import io from'socket.io-client';import'./chat.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";let socket;const Chat=()=>{const[user,setUser]=useState(\"\");const[room,setRoom]=useState(\"\");const[users,setUsers]=useState([]);const[message,setMessage]=useState(\"\");const[messages,setMessages]=useState([]);const socketUrl='http://localhost:8000';useEffect(()=>{const search=window.location.search;const params=new URLSearchParams(search);const user=params.get('name');const room=params.get('room');setUser(user);setRoom(room);socket=io(socketUrl);socket.emit('join',{user,room},err=>{if(err){// alert(err)\n}});return()=>{// User leaves room\nsocket.disconnect();socket.off();};},[socketUrl,window.location.search]);useEffect(()=>{socket.on('message',msg=>{setMessages(prevMsg=>[...prevMsg,msg]);setTimeout(()=>{var div=document.getElementById(\"chat_body\");div.scrollTop=div.scrollHeight-div.clientWidth;},10);});socket.on('roomMembers',usrs=>{setUsers(usrs);});},[]);const sendMessage=e=>{e.preventDefault();socket.emit('sendMessage',message,()=>setMessage(\"\"));setTimeout(()=>{var div=document.getElementById(\"chat_body\");div.scrollTop=div.scrollHeight;},100);};return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-4 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row chat-window\",id:\"chat_window_1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-xs-4 col-md-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"panel-heading top-bar\",children:/*#__PURE__*/_jsx(\"h5\",{children:\"ACTIVE USERS\"})}),/*#__PURE__*/_jsx(\"ul\",{children:users.map((e,i)=>/*#__PURE__*/_jsx(\"li\",{children:e.user},i))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-xs-8 col-md-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"panel panel-default\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"panel-heading top-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-12 col-xs-8\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"panel-title\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"glyphicon glyphicon-comment\"}),room]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"panel-body msg_container_base\",id:\"chat_body\",children:messages.map((e,i)=>e.user===(user===null||user===void 0?void 0:user.toLowerCase())?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"row msg_container base_receive\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-xs-10 col-md-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"messages msg_receive\",children:[/*#__PURE__*/_jsx(\"p\",{children:e.text}),/*#__PURE__*/_jsx(\"time\",{children:e.user})]})})},i)}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"row msg_container base_sent\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-xs-10 col-md-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"messages msg_sent\",children:[/*#__PURE__*/_jsx(\"p\",{children:e.text}),/*#__PURE__*/_jsx(\"time\",{children:e.user})]})})},i)}))}),/*#__PURE__*/_jsx(\"div\",{className:\"panel-footer\",children:/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"input\",{id:\"btn-input\",type:\"text\",value:message,onKeyPress:event=>event.key==='Enter'?sendMessage(event):null,onChange:event=>setMessage(event.target.value),className:\"form-control input-sm chat_input\",placeholder:\"Write your message here...\"})})})]})})]})});};export default Chat;","map":{"version":3,"names":["React","useEffect","useState","io","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","socket","Chat","user","setUser","room","setRoom","users","setUsers","message","setMessage","messages","setMessages","socketUrl","search","window","location","params","URLSearchParams","get","emit","err","disconnect","off","on","msg","prevMsg","setTimeout","div","document","getElementById","scrollTop","scrollHeight","clientWidth","usrs","sendMessage","e","preventDefault","className","children","id","map","i","toLowerCase","text","type","value","onKeyPress","event","key","onChange","target","placeholder"],"sources":["C:/Users/shris/Lets-Chat/client/src/pages/chat/chat.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport io from 'socket.io-client'\r\nimport './chat.css'\r\n\r\nlet socket;\r\nconst Chat = () => {\r\n    const [user, setUser] = useState(\"\");\r\n    const [room, setRoom] = useState(\"\");\r\n    const [users, setUsers] = useState([]);\r\n    const [message, setMessage] = useState(\"\");\r\n    const [messages, setMessages] = useState([]);\r\n    const socketUrl = 'http://localhost:8000'\r\n\r\n    useEffect(() => {\r\n        const search = window.location.search;\r\n        const params = new URLSearchParams(search);\r\n        const user = params.get('name');\r\n        const room = params.get('room');\r\n\r\n        setUser(user)\r\n        setRoom(room)\r\n\r\n        socket = io(socketUrl);\r\n\r\n\r\n\r\n        socket.emit('join', { user, room }, (err) => {\r\n            if (err) {\r\n                // alert(err)\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            // User leaves room\r\n            socket.disconnect();\r\n\r\n            socket.off()\r\n        }\r\n\r\n    }, [socketUrl,window.location.search])\r\n\r\n    useEffect(() => {\r\n        socket.on('message', msg => {\r\n            setMessages(prevMsg => [...prevMsg, msg])\r\n\r\n            setTimeout(() => {\r\n\r\n                var div = document.getElementById(\"chat_body\");\r\n                div.scrollTop = div.scrollHeight - div.clientWidth;\r\n            }, 10)\r\n        })\r\n\r\n        socket.on('roomMembers', usrs => {\r\n            setUsers(usrs)\r\n        })\r\n    }, [])\r\n\r\n    const sendMessage = (e) => {\r\n        e.preventDefault();\r\n       \r\n        socket.emit('sendMessage', message, () => setMessage(\"\"))\r\n        setTimeout(() => {\r\n            var div = document.getElementById(\"chat_body\");\r\n            div.scrollTop = div.scrollHeight ;\r\n        }, 100)\r\n    }\r\n\r\n    return (\r\n        <div className=\"container mt-4 \">\r\n\r\n            <div className=\"row chat-window\" id=\"chat_window_1\" >\r\n                <div className=\"col-xs-4 col-md-4\">\r\n                    <div className=\"panel-heading top-bar\">\r\n                    <h5>ACTIVE USERS</h5>\r\n                    </div>\r\n                    \r\n                    <ul>\r\n                        {\r\n                            users.map((e, i) => (\r\n                                <li key={i}>{e.user}</li>\r\n                            ))\r\n                        }\r\n                    </ul>\r\n                </div>\r\n                <div className=\"col-xs-8 col-md-8\">\r\n                    <div className=\"panel panel-default\">\r\n                        <div className=\"panel-heading top-bar\">\r\n                            <div className=\"col-md-12 col-xs-8\">\r\n                                <h3 className=\"panel-title\"><span className=\"glyphicon glyphicon-comment\"></span>{room}</h3>\r\n                            </div>\r\n\r\n                        </div>\r\n                        <div className=\"panel-body msg_container_base\" id=\"chat_body\">\r\n                            {\r\n                                messages.map((e, i) => (\r\n                                    e.user === user?.toLowerCase() ? <>\r\n                                        <div key={i} className=\"row msg_container base_receive\">\r\n                                            <div className=\"col-xs-10 col-md-10\">\r\n                                                <div className=\"messages msg_receive\">\r\n                                                    <p>{e.text}</p>\r\n                                                    <time>{e.user}</time>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </> : <>\r\n                                        <div key={i} className=\"row msg_container base_sent\">\r\n                                            <div className=\"col-xs-10 col-md-10\">\r\n                                                <div className=\"messages msg_sent\">\r\n                                                    <p>{e.text}</p>\r\n                                                    <time>{e.user}</time>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </>\r\n                                ))\r\n                            }\r\n\r\n                        </div>\r\n                        <div className=\"panel-footer\">\r\n                            <div className=\"input-group\">\r\n                                <input id=\"btn-input\" type=\"text\"\r\n                                    value={message}\r\n                                    onKeyPress={event => event.key === 'Enter' ? sendMessage(event) : null}\r\n                                    onChange={(event) => setMessage(event.target.value)}\r\n                                    className=\"form-control input-sm chat_input\" placeholder=\"Write your message here...\" />\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}